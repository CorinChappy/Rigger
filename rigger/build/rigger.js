(function(){Math.Y=function(a,c,d){return Math.max(c,Math.min(a,d))};var a={width:1E3,height:500,i:{width:716,height:409},canvas:null,b:null,state:0,A:0,U:!1,fa:{ya:["annex","light store","gel draw"],q:["fresnel","pc","parcan","source 4","flood"]},c:{g:null,time:0,n:0,w:0,H:null,h:null,target:null},t:{u:20,volume:1},d:{va:function(b,c){if(0===parseInt(c)%1)return c>=a.fa[b].length||0>c?0:c;var d=a.fa[b].indexOf(c);return 0>d?0:d},la:function(){for(var b=new a.I,c=0;c<=a.t.u;c++)0.3>Math.random()&&
b.X(new a.J(a.l.q[Math.floor(4*Math.random())]),c);return b},o:function(b){a.b.globalAlpha=1;a.b.strokeStyle="black";a.b.fillStyle="black";a.b.font=(b||12)+"px Helvetica";a.b.textAlign="start";a.b.textBaseline="top"}},S:{update:function(b){if(!a.U)for(var c in a.T)a.da[c]&&a.da[c].call(a,b);2===a.state&&(a.S.wa(b),a.c.h.update(),a.c.target.update())},m:function(){a.b.clearRect(0,0,a.width,a.height);a.d.o();switch(a.state){case -1:a.C.error();break;case 0:a.C.ra();break;case 1:a.C.w();break;case 2:a.C.n();
a.d.o(20);a.b.textAlign="right";a.b.fillText("Time: "+(a.c.time/1E3).toFixed(3),a.width-10,10);switch(a.c.w){case 1:a.C.ta.ja();break;case 0:a.c.g.m()}break;case 3:a.b.fillStyle="green",a.b.fillRect(0,0,a.width,a.height),a.c.h.m(),a.d.o(40),a.b.textBaseline="bottom",a.b.fillText("Congratulations! You win",a.width/10,4*a.height/10),a.b.textBaseline="top",a.b.fillText("In time: "+(a.c.time/1E3).toFixed(3),a.width/10,4*a.height/10),a.b.textAlign="center",a.b.fillStyle="yellow",a.b.textBaseline="bottom",
a.b.fillText("Play again?",a.width/2,a.height-a.height/10)}},wa:function(b){a.c.time+=1E3*b}},C:{n:function(){switch(a.c.n){case 0:a.b.fillStyle="green";a.b.fillRect(0,0,a.width,a.height);a.d.o(20);a.b.textAlign="right";a.b.fillText("Light Store \u21d2",a.width-10,400);a.c.H.m();a.c.h.m();break;case 1:a.d.o(20);a.b.fillText("Light Store",20,10);a.b.fillStyle="#4775FF";a.b.fillRect(0,a.height-a.i.height,a.i.width,a.i.height);a.b.drawImage(a.f.s.ia.qa,0,a.height-a.i.height,a.i.width,a.i.height);for(var b=
a.l.q,c=a.i.width/36,d=a.i.width/2/b.length,e=a.height-a.i.height+a.i.height/13.6,f=a.i.height/4.5,h=0;h<b.length;h++)for(var g=0;4>g;g++)a.b.drawImage(b[h].G(),c+d*h,e+f*g,b[h].e,b[h].d)}},ta:{ja:function(){a.d.o(24);a.b.fillStyle="brown";a.b.fillRect(0,0,a.width,a.height);a.c.target.m();a.b.fillStyle="black";a.b.fillText("Design",250,400)}},error:function(){a.b.fillStyle="green";a.b.fillRect(0,0,a.width,a.height);a.d.o(20);a.b.textBaseline="bottom";a.b.fillText("Oh PANTS.",10,200);a.b.textBaseline=
"top";a.b.fillText("An error has occurred, see the console for more info",25,205)},ra:function(){a.b.fillStyle="green";a.b.fillRect(0,0,a.width,a.height);a.d.o(24);a.b.textBaseline="bottom";a.b.fillText("LOADING...",20,200);a.b.clearRect(20,205,200,20);a.b.fillRect(20,205,2*a.f.loaded,20)},w:function(){a.b.fillStyle="green";a.b.fillRect(0,0,a.width,a.height);a.d.o(24);a.b.fillText("Welcome to Rigger!",20,10);a.b.textAlign="center";a.b.textBaseline="bottom";a.b.fillText("Pick a character",a.width/
2,a.height/5);a.d.o(18);a.b.textAlign="center";var b=a.height/5,c=Object.keys(a.l.v).length,d=a.height-b-a.height/10,e=0,f;for(f in a.l.v){var h=a.l.v[f],g=d/h.d*h.e,k=(a.width-g*c)/c,g=[g,d],k=[k/2+k*e+g[0]*e,b];e===a.A?(a.b.globalAlpha=0.5,a.b.fillStyle="yellow",a.b.fillRect(k[0],k[1],g[0],g[1]),a.b.globalAlpha=1):a.b.fillStyle="black";a.b.drawImage(h.p.N,k[0],k[1],g[0],g[1]);a.b.fillText(h.name,k[0]+g[0]/2,k[1]+g[1]+10);e++}}},sa:function(b){a.c.g=new a.W(b||a.l.v.R);a.c.target=a.d.la();a.c.h=
new a.I;a.c.H=new a.ha;a.U=!1;a.c.w=0;a.c.time=0;a.state=2},pause:function(){},ma:function(b,c,d){if(!b)throw Error("Where do I put my canvas?!");c&&d&&(a.width=c,a.height=d,a.i.width=c/1.396,a.i.height=d/1.222);c=document.createElement("canvas");d=c.getContext("2d");c.width=a.width;c.height=a.height;b.appendChild(c);a.canvas=c;a.b=d;gameloop(function(b){a.S.update(b);a.S.m()});a.f.load(function(b,c){if(!0===b)a.state=1;else throw a.state=-1,Error('Asset "'+c+"\" couldn't load :(");})}};window.rigger=
a;window.rigger.init=a.ma;"use strict";a.ka={};"use strict";a.f={s:{ia:{qa:"assets/sprites/bg/lampy.png"},q:["assets/sprites/lights/fresnel.png","assets/sprites/lights/pc.png","assets/sprites/lights/par.png","assets/sprites/lights/source4.png"],g:{R:{left:"assets/sprites/player/danbarr/left.png",right:"assets/sprites/player/danbarr/right.png",L:"assets/sprites/player/danbarr/climb.png",M:"assets/sprites/player/danbarr/climb2.png",N:"assets/sprites/player/danbarr/front.png"},ga:{left:"assets/sprites/player/trojak/left.png",
right:"assets/sprites/player/trojak/right.png",L:"assets/sprites/player/trojak/climb.png",M:"assets/sprites/player/trojak/climb2.png",N:"assets/sprites/player/trojak/front.png"},$:{left:"assets/sprites/player/corin/left.png",right:"assets/sprites/player/corin/right.png",L:"assets/sprites/player/corin/climb.png",M:"assets/sprites/player/corin/climb2.png",N:"assets/sprites/player/corin/front.png"}},hidden:{P:{left:"assets/sprites/player/rory/rory.png",right:"assets/sprites/player/rory/rory.png",L:"assets/sprites/player/rory/rory.png",
M:"assets/sprites/player/rory/rory.png",N:"assets/sprites/player/rory/rory.png"}}},k:{P:["assets/audio/rory.ogg","assets/audio/rory.mp3"]},load:function(b){function c(c){h||(c?(b.call(a,!1,c),h=!0):(a.f.loaded=e/d*100,a.f.ca()&&b.call(a,!0)))}var d=0,e=0,f=!1,h=!1;(function n(a,b){var f=a[b];if("string"===typeof f){d++;var g=new Image;g.addEventListener("load",function(){a[b]=g;e++;c()});g.addEventListener("error",function(){c(f)});g.src=f}else for(var h in f)n(f,h)})(a.f,"sprites");var g=function(){var a=
new Audio;return""!=a.canPlayType("audio/ogg; codecs=vorbis")?0:""!=a.canPlayType("audio/mpeg")?1:-1}();if(0<=g)for(var k in a.f.k){d++;var m=a.f.k[k][g],l=new Audio;l.addEventListener("canplaythrough",function(){a.f.k[k]=l;e++;c()});l.addEventListener("error",function(){c(m)});l.src=m;l.volume=a.t.volume}else for(k in a.f.k)a.f.k[k]={pause:function(){},play:function(){}};f=!0;a.f.ca=function(){return f&&d===e};c()},ca:function(){return!1},loaded:0};"use strict";a.W=function(b){this.r=b.r;this.speed=
b.r[0];this.j=null;this.ba={x:30,y:50};this.p=b.p;this.a={e:b.e,d:b.d,x:5,y:0,F:this.p.right,Q:!0,K:1};this.a.y=a.height-this.a.d;this.m=function(){a.b.drawImage(this.a.F,this.a.x,this.a.y,this.a.e,this.a.d);this.j&&this.j.m()};this.update=function(b,d){switch(d){case 37:case 39:var e=0-2*this.a.e/3,f=0===a.c.n?a.width-this.a.e/3:a.i.width-this.a.e;this.a.y>=a.height-this.a.d&&(this.a.x=Math.Y(this.a.x+this.speed*b*(d-38),e,f),this.a.F=39===d?this.p.right:this.p.left);break;case 38:case 40:if(0!==
a.c.n)break;e=a.c.H.a;f=e.e/5;a.c.g.a.x>e.x-2*f&&a.c.g.a.x<e.x+e.e-2*f&&(this.a.y=Math.Y(this.a.y+this.speed*b*(d-39),e.y,a.height-this.a.d),this.a.K-=4*b,0>=this.a.K&&(this.a.Q=!this.a.Q,this.a.K=1),this.a.F=this.a.Q?this.p.L:this.p.M);break;case 32:if(0===a.c.n&&(e=a.c.h,this.a.y===a.c.H.a.y&&(f=a.width/a.t.u,f=Math.floor((this.a.x+f/2)/f),this.j?e.X(this.j,f)&&(this.j=null,this.speed=this.r[0]):this.j=e.ua(f))),1===a.c.n){var e=a.i.width/2,f=a.i.width/36,h=e/a.l.q.length;if(this.a.x>f||this.a.x<
e)e=Math.floor((this.a.x+f)/h),this.j?e===this.j.type().B&&(this.j=null,this.speed=this.r[0]):this.j=new a.J(a.l.q[e])}}this.j&&(this.speed=this.r[3],this.j.a.x=this.a.x+this.ba.x,this.j.a.y=this.a.y+this.ba.y)}};a.I=function(){this.h=function(a){for(var b=[];b.length<a;)b.push(!1);return b}(a.t.u);var b={};this.X=function(c,d){if(!c||0>d||d>=a.t.u||this.h[d])return!1;this.h[d]=c;return b[d]=!0};this.ua=function(b){if(!(0>b||b>=a.t.u)){if(!this.h[b])return null;var d=this.h[b];this.h[b]=!1;return d}};
this.a={x:0,y:50,B:5,pa:a.width};this.m=function(){a.b.strokeStyle="black";a.b.lineWidth=this.a.B;a.b.beginPath();a.b.moveTo(this.a.x,this.a.y);a.b.lineTo(this.a.x+this.a.pa,this.a.y);a.b.stroke();this.h.forEach(function(a){a&&a.m()})};this.update=function(){for(var c in b)this.h[c].a.x=a.width/a.t.u*c,this.h[c].a.y=this.a.y+1,delete b[c]}};a.I.D=function(b,c){if(!b||!c)return!1;for(var d=0;d<a.t.u;d++)if(!a.J.D(b.h[d],c.h[d]))return!1;return!0};a.J=function(b){this.type=function(){return b};this.aa=
null;this.a={x:0,y:0,e:b.e,d:b.d,F:b.G()};this.m=function(){a.b.drawImage(this.a.F,this.a.x,this.a.y,this.a.e,this.a.d)}};a.J.D=function(b,c){return b&&c?b.type()===c.type()&&a.V.D(b.aa,c.aa)?!0:!1:!b&&!c};a.V=function(b,c){c=a.d.va("lights",c);this.type=function(){return c};var d=a.ka[b];this.Z=function(){return d}};a.V.D=function(a,c){return a&&c?a.type()!==c.type()||a.Z()!==c.Z()?!1:!0:!a&&!c};a.ha=function(){this.position=0;this.a={e:75,d:475,x:50};this.a.y=a.height-this.a.d;this.m=function(){a.d.o();
var b=this.a.e/5;a.b.lineWidth=b;a.b.strokeStyle="gray";a.b.beginPath();a.b.moveTo(this.a.x+b/2,this.a.y);a.b.lineTo(this.a.x+b/2,a.height);a.b.stroke();a.b.beginPath();a.b.moveTo(this.a.x+this.a.e-b,this.a.y);a.b.lineTo(this.a.x+this.a.e-b,a.height);a.b.stroke();for(var c=this.a.d/9,d=0;9>d;d++)a.b.beginPath(),a.b.moveTo(this.a.x-b/2,this.a.y+c*d+20),a.b.lineTo(this.a.x+this.a.e,this.a.y+c*d+20),a.b.stroke()};this.update=function(){var b=a.c.g,c=this.a.e/5;b.a.y===a.height-b.a.d&&b.a.x>this.a.x-
2*c&&b.a.x<this.a.x+this.a.e-2*c&&!b.j&&(this.a.x=b.a.x)}};"use strict";a.T={};a.ea={na:function(b){a.T[b.keyCode]=!0;a.O[b.keyCode]&&!a.U&&a.O[b.keyCode].call(a)},oa:function(b){delete a.T[b.keyCode]}};window.addEventListener("keydown",a.ea.na);window.addEventListener("keyup",a.ea.oa);window.Ca={left:37,up:38,right:39,down:40,space:32};a.da={37:function(b){if(2===a.state){var c=a.c.g;1===a.c.n&&c.a.x<=0-c.a.e/2&&(c.a.x=a.width-c.a.e,a.c.n=0);c.update(b,37)}},38:function(b){2===a.state&&a.c.g.update(b,
38)},39:function(b){if(2===a.state){var c=a.c.g;0===a.c.n&&c.a.x>=a.width-c.a.e/2&&(c.a.x=0,a.c.n=1);a.c.g.update(b,39)}},40:function(b){2===a.state&&a.c.g.update(b,40)},32:function(){2===a.state&&0===a.c.n&&this.c.H.update()}};a.O={37:function(){1===a.state&&(a.A=Math.max(0,a.A-1))},38:function(){},39:function(){1===a.state&&(a.A=Math.min(a.A+1,Object.keys(a.l.v).length-1))},40:function(){},32:function(){if(1===a.state)a.sa(a.l.v[Object.keys(a.l.v)[a.A]]);else{if(2===a.state&&(a.c.g.update(0,32),
a.I.D(a.c.h,a.c.target))){a.state=3;return}3===a.state&&(a.state=1)}},68:function(){2===a.state&&(a.c.w=0===a.c.w?1:0)},82:function(){if(2===a.state){var b=a.c.g.a.x,c=a.c.g.j,d=new a.W(a.l.hidden.P);d.a.x=b;d.j=c;a.c.g=d;d.update(0);a.k.play("rory")}}};a.O[13]=a.O[32];"use strict";a.k={play:function(b){(b=a.f.k[b])&&b.play&&b.play()},xa:function(b){a.f.k[b].loop=!0;a.k.play(b)},stop:function(b){(b=a.f.k[b])&&b.play&&(b.loop=!1,b.pause(),b.currentTime=0)},za:function(b){for(var c in a.f.k)a.f.k[c].volume=
b},Ba:function(){setVol(0.1)},Aa:function(){setVol(-0.1)}};"use strict";a.l={q:[{name:"fresnel",B:0,G:function(){return a.f.s.q[0]},d:68,e:38},{name:"pc",B:1,G:function(){return a.f.s.q[1]},d:68,e:38},{name:"parcan",B:2,G:function(){return a.f.s.q[2]},d:64,e:50},{name:"source 4",B:3,G:function(){return a.f.s.q[3]},d:76,e:50}],v:{R:{name:"danbarr",p:a.f.s.g.R,r:[300,200,150,200],d:100,e:62},ga:{name:"Trojak",p:a.f.s.g.ga,r:[300,200,150,200],d:100,e:62},$:{name:"Corin",p:a.f.s.g.$,r:[300,200,150,200],
d:100,e:62}},hidden:{P:{name:"Rory",p:a.f.s.hidden.P,r:[200,200,150,200],d:150,e:100}}}})();